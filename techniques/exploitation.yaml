layer: exploitation
description: "Metasploit auxiliary module scanning â€” maps open ports to relevant scanner modules for vulnerability validation"
techniques:
  - name: "Metasploit Auxiliary Scan"
    tool: msf_scanner
    command: "python3 /pentest/msf_scanner.py --target {target} --ports {open_ports} --intensity {intensity}"
    description: "Run Metasploit auxiliary/scanner modules against discovered open ports. Selects modules based on port-service mapping, generates a batched resource script, and runs msfconsole once for efficiency."
    intensity: standard
    timeout: 900
    parse_hint: >
      Analyze Metasploit auxiliary module scan results. Each module result
      includes the MSF module path, target port, severity hint, and raw output.
      Prioritize confirmed vulnerabilities (e.g. MS17-010, BlueKeep, anonymous access,
      default credentials) over informational version detections. [+] markers indicate
      positive results. Version detection modules are informational unless they reveal
      known vulnerable versions.

  - name: "SMB Vulnerability Check"
    tool: msfconsole
    command: "msfconsole -q -x 'use auxiliary/scanner/smb/smb_ms17_010; set RHOSTS {target}; run; exit' 2>/dev/null"
    description: "Check for MS17-010 (EternalBlue) and related SMB vulnerabilities"
    intensity: quick
    timeout: 300
    depends_on_ports: [445]
    parse_hint: >
      Analyze Metasploit output for MS17-010 vulnerability confirmation.
      A positive result indicates the target is vulnerable to EternalBlue.
      This is a critical finding that enables remote code execution.

  - name: "SSH Version Check"
    tool: msfconsole
    command: "msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_version; set RHOSTS {target}; run; exit' 2>/dev/null"
    description: "Enumerate SSH version for known vulnerabilities"
    intensity: quick
    timeout: 120
    depends_on_ports: [22]
    parse_hint: >
      Identify SSH server version and check for known CVEs.

  - name: "FTP Anonymous Access Check"
    tool: msfconsole
    command: "msfconsole -q -x 'use auxiliary/scanner/ftp/anonymous; set RHOSTS {target}; run; exit' 2>/dev/null"
    description: "Check for anonymous FTP access"
    intensity: quick
    timeout: 120
    depends_on_ports: [21]
    parse_hint: >
      Determine if anonymous FTP login is allowed.
